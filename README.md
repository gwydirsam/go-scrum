# `scrum`

A Joyent scrum utility.

## Installation

1. Install `scrum`: `go get -v -u github.com/gwydirsam/go-scrum/cmd/scrum`
2. Make sure `scrum` is in your path:

    ```
    $ export GOPATH=`go env GOPATH`
    $ export PATH=$GOPATH/bin:$PATH
    $ which scrum
    ~/go/bin/scrum
    ```

3. Initialize a config file or set environment variables.
  1. To use the `scrum` config file, use run `scrum init` to generate a default
     config file (default path: `$HOME/.config/scrum/scrum.toml`).
  2. Set environment variables.  See the #direnv section below.

Regardless of which config format used, `MANTA_KEY_ID` is generated by one of the
following:

```
$ ssh-keygen -E md5 -lf ~/.ssh/id_rsa.pub | awk '{print $2}' | cut -d : -f 2-
$ ssh-keygen -E md5 -lf ~/.ssh/id_ecdsa.pub | awk '{print $2}' | cut -d : -f 2-
```

## Usage

```
$ scrum -h
scrum is used internally to post and read the daily scrum at Joyent.

Usage:
  scrum [command]

Examples:
  $ scrum get             # Get my scrum for today
  $ scrum get -a          # Get everyone's scrum
  $ scrum set -i today.md # Set my scrum using today.md
  $ scrum list            # List scrummers for the day

Available Commands:
  get         Get scrum information
  help        Help about any command
  init        Generate an initial scrum configuration file
  list        List scrum information
  set         Set scrum information
  version     Display scrum version and build information

Flags:
  -C, --country string           Country holiday schedule (default "us")
  -h, --help                     help for scrum
  -F, --log-format string        Specify the log format ("auto", "zerolog", or "human") (default "auto")
  -l, --log-level string         Change the log level being sent to stdout (default "INFO")
  -A, --manta-account string     Manta account name (default "$MANTA_USER")
      --manta-key-id string      SSH key fingerprint (default is $MANTA_KEY_ID)
  -T, --manta-timeout duration   Manta API timeout (default 3s)
  -E, --manta-url string         URL of the Manta instance (default is $MANTA_URL) (default "https://us-east.manta.joyent.com")
  -U, --manta-user string        Manta username to scrum as (default "$MANTA_USER")
  -B, --scrum-account string     Manta account for scrum board/files (default "Joyent_Dev")
  -S, --stats                    Log Manta client latency stats on exit (default true)
      --use-color                Use ASCII colors
  -P, --use-pager                Use a $PAGER to read output (defaults to $PAGER, less(1), or more(1)) (default true)
  -u, --user string              Scrum for specified user (default "$USER")
  -Z, --utc                      Display times in UTC

Use "scrum [command] --help" for more information about a command.
```

### `scrum get` Usage

```
$ scrum get
Vacation until 2017/11/24
$ scrum get -h
Get scrum information, either for yourself (or teammates)

Usage:
  scrum get [flags]

Examples:
  $ scrum get                      # Get my scrum for today
  $ scrum get -t -u other.username # Get other.username's scrum for tomorrow

Flags:
  -a, --all                     Get scrum for all users
  -D, --date string             Date for scrum (default "2018-03-12")
  -h, --help                    help for get
  -H, --highlight stringArray   Highlight words definition
  -t, --tomorrow                Get scrum for the next weekday
  -y, --yesterday               Get scrum for the previous weekday

Global Flags:
  -C, --country string           Country holiday schedule (default "us")
  -F, --log-format string        Specify the log format ("auto", "zerolog", or "human") (default "auto")
  -l, --log-level string         Change the log level being sent to stdout (default "INFO")
  -A, --manta-account string     Manta account name (default "$MANTA_USER")
      --manta-key-id string      SSH key fingerprint (default is $MANTA_KEY_ID)
  -T, --manta-timeout duration   Manta API timeout (default 3s)
  -E, --manta-url string         URL of the Manta instance (default is $MANTA_URL) (default "https://us-east.manta.joyent.com")
  -U, --manta-user string        Manta username to scrum as (default "$MANTA_USER")
  -B, --scrum-account string     Manta account for scrum board/files (default "Joyent_Dev")
  -S, --stats                    Log Manta client latency stats on exit (default true)
      --use-color                Use ASCII colors
  -P, --use-pager                Use a $PAGER to read output (defaults to $PAGER, less(1), or more(1)) (default true)
  -u, --user string              Scrum for specified user (default "$USER")
  -Z, --utc                      Display times in UTC
```

#### `scrum get` Keyword Highlighting

`scrum` can highlight keywords.  Each keyword must be configured with a color
definition in the `scrum` configuration file.  The following snippet is the
default configuration file for a token (TOML encoding):

```
[higlight]
# Change the font for "token" to be red and underlined.  Perform an exact match.
token = "red underline"

# Perform a substring match for "lorem".  Useful for small keywords.
"lorem~" = "blue blink reverse"

# Search for "foobar" with a Damerauâ€“Levenshtein distance of 2.  Useful for misspelled words.
"foobar~2" = "italic"
```

See [Color Definitions](#color-definitions) for a list of available colors.

### `scrum set` Usage

```
$ scrum set -h
Set scrum information, either for yourself (or teammates)

Usage:
  scrum set [flags]

Examples:
  $ scrum set -i today.md                         # Set my scrum using today.md
  $ scrum set -u other.username -t -i tomorrow.md # Set other.username's scrum for tomorrow

Flags:
  -D, --date string     Date for scrum (default "2018-03-12")
  -d, --days uint       Recycle scrum update for N days
  -i, --file string     File to read scrum from
  -f, --force           Force overwrite of any present scrum
  -h, --help            help for set
  -s, --sick uint       Sick leave for N days
  -t, --tomorrow        Set scrum for the next weekday
  -v, --vacation uint   Vacation for N days

Global Flags:
  -C, --country string           Country holiday schedule (default "us")
  -F, --log-format string        Specify the log format ("auto", "zerolog", or "human") (default "auto")
  -l, --log-level string         Change the log level being sent to stdout (default "INFO")
  -A, --manta-account string     Manta account name (default "$MANTA_USER")
      --manta-key-id string      SSH key fingerprint (default is $MANTA_KEY_ID)
  -T, --manta-timeout duration   Manta API timeout (default 3s)
  -E, --manta-url string         URL of the Manta instance (default is $MANTA_URL) (default "https://us-east.manta.joyent.com")
  -U, --manta-user string        Manta username to scrum as (default "$MANTA_USER")
  -B, --scrum-account string     Manta account for scrum board/files (default "Joyent_Dev")
  -S, --stats                    Log Manta client latency stats on exit (default true)
      --use-color                Use ASCII colors
  -P, --use-pager                Use a $PAGER to read output (defaults to $PAGER, less(1), or more(1)) (default true)
  -u, --user string              Scrum for specified user (default "$USER")
  -Z, --utc                      Display times in UTC
```

### `scrum list` Usage

```
$ scrum list -h
List scrum information for the day

Usage:
  scrum list [flags]

Aliases:
  list, ls

Examples:
  $ scrum list                      # List scrummers for the day
  $ scrum list -t

Flags:
  -a, --all           List all metadata details (default true)
  -D, --date string   Date for scrum (default "2018-03-12")
  -h, --help          help for list
  -t, --tomorrow      List scrums for the next weekday
  -1, --usernames     List usernames only
  -y, --yesterday     List scrum for the previous weekday

Global Flags:
  -C, --country string           Country holiday schedule (default "us")
  -F, --log-format string        Specify the log format ("auto", "zerolog", or "human") (default "auto")
  -l, --log-level string         Change the log level being sent to stdout (default "INFO")
  -A, --manta-account string     Manta account name (default "$MANTA_USER")
      --manta-key-id string      SSH key fingerprint (default is $MANTA_KEY_ID)
  -T, --manta-timeout duration   Manta API timeout (default 3s)
  -E, --manta-url string         URL of the Manta instance (default is $MANTA_URL) (default "https://us-east.manta.joyent.com")
  -U, --manta-user string        Manta username to scrum as (default "$MANTA_USER")
  -B, --scrum-account string     Manta account for scrum board/files (default "Joyent_Dev")
  -S, --stats                    Log Manta client latency stats on exit (default true)
      --use-color                Use ASCII colors
  -P, --use-pager                Use a $PAGER to read output (defaults to $PAGER, less(1), or more(1)) (default true)
  -u, --user string              Scrum for specified user (default "$USER")
  -Z, --utc                      Display times in UTC
```

### `scrum init` Usage

```
$ scrum init -h
Generate an initial scrum configuraiton file

Usage:
  scrum init [flags]

Examples:
  $ scrum init                 # Create a new scrum config file
  $ scrum init -f -            # Write the config file to stdout
  $ scrum init -f ./scrum.toml # Create a new scrum config file

Flags:
  -f, --file string   Config file to initialize (default "~/.config/scrum/scrum.toml")
  -h, --help          help for init

Global Flags:
  -C, --country string           Country holiday schedule (default "us")
  -F, --log-format string        Specify the log format ("auto", "zerolog", or "human") (default "auto")
  -l, --log-level string         Change the log level being sent to stdout (default "INFO")
  -A, --manta-account string     Manta account name (default "$MANTA_USER")
      --manta-key-id string      SSH key fingerprint (default is $MANTA_KEY_ID)
  -T, --manta-timeout duration   Manta API timeout (default 3s)
  -E, --manta-url string         URL of the Manta instance (default is $MANTA_URL) (default "https://us-east.manta.joyent.com")
  -U, --manta-user string        Manta username to scrum as (default "$MANTA_USER")
  -B, --scrum-account string     Manta account for scrum board/files (default "Joyent_Dev")
  -S, --stats                    Log Manta client latency stats on exit (default true)
      --use-color                Use ASCII colors
  -P, --use-pager                Use a $PAGER to read output (defaults to $PAGER, less(1), or more(1)) (default true)
  -u, --user string              Scrum for specified user (default "$USER")
  -Z, --utc                      Display times in UTC
% scrum init -f - -Afirst.lastname --manta-key-id=8b:ad:f0:0d:de:ad:be:ef:de:ad:c0:de:ba:dd:ca:fe -Umyuser
[general]
country = "us"

[highlight]
#keyword   = "red underline" # exact match "keyword"
#"substr~" = "italic green"  # substring match "substr"
#"fuzzy~2" = "reverse blue"  # match "fuzzy" with a distance of 2

[log]
#format    = "auto"
#level     = "INFO"
#stats     = true
#use-color = true

[manta]
account       = "first.lastname"
key-id        = "8b:ad:f0:0d:de:ad:be:ef:de:ad:c0:de:ba:dd:ca:fe"
scrum-account = "Joyent_Dev"
timeout       = "3s"
url           = "https://us-east.manta.joyent.com"
user          = "myuser"
```

## `direnv`

1. Install [`direnv`](https://github.com/direnv/direnv) and integrate into your
   shell.
2. Populate a `.envrc` file:

    ```
    export MANTA_USER=my-manta-username
    export MANTA_URL=https://us-east.manta.joyent.com
    export MANTA_KEY_ID=00:11:22:33:44:55:66:77:88:99:aa:bb:cc:dd:ee:ff
    ```

3. `direnv allow` the directory containing the `.envrc` file (e.g. `cd ~/src/joyent/engdoc && direnv allow`).


## Color Definitions

| Color Attribute | Description |
| --------------- | ----------- |
| `bold` | **bold** |
| `faint` | |
| `italic` | *Italic* |
| `underline` | Underline word |
| `blink` | Slow blink |
| `reverse` | |
| `strikethrough` | ~~Strikethrough~~ |
| `black`, `fg-black` | |
| `red`, `fg-red` | |
| `green`, `fg-green` | |
| `yellow`, `fg-yellow` | |
| `blue`, `fg-blue` | |
| `magenta`, `fg-magenta` | |
| `cyan`, `fg-cyan` | |
| `white`, `fg-white` | |
| `black-low`, `fg-black-low` | |
| `red-low`, `fg-red-low` | |
| `green-low`, `fg-green-low` | |
| `yellow-low`, `fg-yellow-low` | |
| `blue-low`, `fg-blue-low` | |
| `magenta-low`, `fg-magenta-low` | |
| `cyan-low`, `fg-cyan-low` | |
| `white-low`, `fg-white-low` | |
| `bg-black` | |
| `bg-red` | |
| `bg-green` | |
| `bg-yellow` | |
| `bg-blue` | |
| `bg-magenta` | |
| `bg-cyan` | |
| `bg-white` | |
| `bg-black-low` | |
| `bg-red-low` | |
| `bg-green-low` | |
| `bg-yellow-low` | |
| `bg-blue-low` | |
| `bg-magenta-low` | |
| `bg-cyan-low` | |
| `bg-white-low` | |

Color definitions are additive.
